<!-- Filtros -->
<div class="filtros-container">


  <div class="acciones">
  <button mat-raised-button color="primary" (click)="abrirDialogoNuevaCompra()">
    + Añadir compra
  </button>
</div>


    <mat-form-field>
    <input matInput placeholder="Buscar proveedor" [(ngModel)]="proveedorFiltro" (input)="buscarProveedor($event)">
  </mat-form-field>

  <!-- Botones de moneda -->
  <mat-button-toggle-group [(ngModel)]="monedaFiltro" (change)="seleccionarMoneda(monedaFiltro)">
    <mat-button-toggle value="TODOS">Todos</mat-button-toggle>
    <mat-button-toggle value="USD">USD</mat-button-toggle>
    <mat-button-toggle value="BOB">BOB</mat-button-toggle>
  </mat-button-toggle-group>

  <!-- Rango de fechas -->
  <mat-form-field>
    <input matInput [matDatepicker]="pickerInicio" [(ngModel)]="fechaInicio" (dateChange)="seleccionarFechaInicio($event)" placeholder="Fecha inicio">
    <mat-datepicker-toggle matSuffix [for]="pickerInicio"></mat-datepicker-toggle>
    <mat-datepicker #pickerInicio></mat-datepicker>
  </mat-form-field>

  <mat-form-field>
    <input matInput [matDatepicker]="pickerFin" [(ngModel)]="fechaFin" (dateChange)="seleccionarFechaFin($event)" placeholder="Fecha fin">
    <mat-datepicker-toggle matSuffix [for]="pickerFin"></mat-datepicker-toggle>
    <mat-datepicker #pickerFin></mat-datepicker>
  </mat-form-field>

  <!-- Buscador de proveedor -->


  <button mat-button color="primary" (click)="limpiarFiltros()">Limpiar filtros</button>
</div>


<mat-accordion>
  <mat-expansion-panel *ngFor="let compra of comprasFiltradas">
    <mat-expansion-panel-header class="custom-header">
      <mat-panel-title>
        Compra #{{ compra.id }} - {{ compra.proveedor.nombre }}
      </mat-panel-title>
      <mat-panel-description>
        Precio Unit: {{ compra.precioUnit | currency: compra.moneda }} -
        Costo Total: {{ compra.montoUSD | currency: compra.moneda }} -
        Fecha de Compra: {{ compra.fecha }}
      </mat-panel-description>
    </mat-expansion-panel-header>

    <!-- Título de la sección de barras -->
    <h3 class="barras-title">Información de las barras</h3>

    <!-- Tabla de barras -->
    <table mat-table [dataSource]="compra.barras" class="mat-elevation-z2 inner-table">

      <!-- Peso -->
      <ng-container matColumnDef="pesoGr">
        <th mat-header-cell *matHeaderCellDef>Peso (gr)</th>
        <td mat-cell *matCellDef="let barra">{{ barra.pesoGr }}</td>
      </ng-container>

      <!-- Pureza -->
      <ng-container matColumnDef="pureza">
        <th mat-header-cell *matHeaderCellDef>Pureza</th>
        <td mat-cell *matCellDef="let barra">{{ barra.pureza }}</td>
      </ng-container>

      <!-- Peso Fino -->
      <ng-container matColumnDef="pesoFino">
        <th mat-header-cell *matHeaderCellDef>Peso Fino</th>
        <td mat-cell *matCellDef="let barra">{{ barra.pesoFino }}</td>
      </ng-container>

      <!-- Onzas -->
      <ng-container matColumnDef="onzas">
        <th mat-header-cell *matHeaderCellDef>Onzas</th>
        <td mat-cell *matCellDef="let barra">{{ barra.onzas }}</td>
      </ng-container>

      <!-- Precio Unitario -->
      <ng-container matColumnDef="precioUnit">
        <th mat-header-cell *matHeaderCellDef>Precio Unit.</th>
        <td mat-cell *matCellDef="let barra">{{ barra.precioUnit | currency: compra.moneda }}</td>
      </ng-container>

      <!-- Monto Total -->
      <ng-container matColumnDef="montoTotal">
        <th mat-header-cell *matHeaderCellDef>Monto Total</th>
        <td mat-cell *matCellDef="let barra">{{ barra.montoTotal | currency: compra.moneda }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['pesoGr','pureza','pesoFino','onzas','precioUnit','montoTotal']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['pesoGr','pureza','pesoFino','onzas','precioUnit','montoTotal'];"></tr>
    </table>
  </mat-expansion-panel>
</mat-accordion>
